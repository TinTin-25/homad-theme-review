{%- include 'section_style' -%}
{%- capture extend_style -%}
    {%- if section.settings.margin_block_d != blank -%}
        --et-mg: {{ section.settings.margin_block_d }};
    {%- endif -%}
    {%- if section.settings.margin_block_m != blank -%}
        --et-mg-mb: {{ section.settings.margin_block_m }};
    {%- endif -%}
{% endcapture %}
<div class="section-newsletter" style="{{ extend_style }}"> 
    <div class="vela-section__inner vela-section overflow-hidden newsletter-layout__{{ section.settings.newsletter_layout }}{% if section.settings.max_with != blank %} mx-auto{%  endif %}" style="{{- section_style -}}">
        <div class="container{% if section.settings.full_with %}-fluid{% endif %}">
            {%- if section.settings.newsletter_layout == 'style1'-%}
                <div class="section-newsletter__wrap mx-auto">
                    {%- if section.settings.heading != blank -%}
                        <div class="heading-group">
                            <h2 class="heading text-center mb-0">
                                <span>{{ section.settings.heading }}</span>
                            </h2>
                        </div>
                    {%- endif -%}
                    {%- if section.settings.description != blank -%}
                        <div class="section-newsletter__desc text-center fs-6 mt-2">
                            {{ section.settings.description }}
                        </div>
                    {%- endif -%}
                    <div class="section-newsletter__content mt-4 mt-md-5 mx-auto">
                        {%- if section.settings.mailchimp -%}
                            {%- assign form_action = section.settings.newsletter_form_action | replace: '/post?', '/post-json?' | append: '&amp;c=?' -%}
                            <form action="{{ form_action }}" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank" class="js-vela-newsletter formNewsletter clearfix">			
                                <input type="hidden" name="contact[tags]" value="newsletter">
                                <div class="d-flex">
                                    <input class="js-input-newsletter form-control bg-transparent" type="email" value="{% if customer %}{{ customer.email }}{% endif %}" placeholder="{{ 'newsletter.newsletter_email' | t }}" name="EMAIL" id="mail" aria-label="{{ 'newsletter.newsletter_email' | t }}" aria-describedby="btn-newsletter" required>					
                                    <button class="btn btn--newsletter btn-default" type="submit">
                                        <span class="text d-block">{{ 'newsletter.button_label' | t }}</span>
                                        <i class="icons d-none">{% render 'icons', icon: 'paper-plane-o', attr: 'width="16"' %}</i>
                                    </button>
                                </div>
                            </form>
                        {% else %}
                            {% form 'customer' %}
                                {%- if form.errors -%}
                                    <div class="alert-error alert alert-danger alert-dismissible fade show">
                                        {{ form.errors | default_errors }}
                                        <button type="button" data-dismiss="alert" aria-hidden="true" data-bs-dismiss="alert" aria-label="Close" class="btn-close"></button>
                                    </div>
                                {%- endif -%}
                                {%- if form.posted_successfully? -%}
                                    <div class="alert-success alert alert-success">
                                        {{ 'newsletter.newsletter_confirmation' | t }}
                                    </div>
                                {%- else -%}
                                    <input type="hidden" name="contact[tags]" value="newsletter">
                                    <div class="d-flex">
                                        <input class="form-control bg-transparent" id="newsletter-input" type="email" name="contact[email]" placeholder="{{ 'newsletter.newsletter_email' | t }}" required aria-describedby="btn-newsletter">
                                        <button class="btn btn--newsletter btn-default" type="submit">
                                            <span class="text d-block">{{ 'newsletter.button_label' | t }}</span>
                                            <i class="icons d-none">{% render 'icons', icon: 'paper-plane-o', attr: 'width="16"' %}</i>
                                        </button>
                                    </div>
                                    <input type="hidden" name="action" value="0">
                                {%- endif -%}
                            {% endform %}
                        {% endif %}
                    </div>
                </div>
            {%- else -%}
                <div class="section-newsletter__wrap ms-auto">
                    <div class="row g-3 align-items-center justify-content-between">
                        <div class="section-newsletter__content col-12">
                            {%- if section.settings.heading != blank -%}
                                <div class="section-newsletter__heading">
                                    <h2 class="heading mb-2">
                                        <span>{{ section.settings.heading }}</span>
                                    </h2>
                                </div>
                            {%- endif -%}
                            {%- if section.settings.description != blank -%}
                                <div class="section-newsletter__desc">
                                    {{ section.settings.description }}
                                </div>
                            {%- endif -%}
                        </div>
                        <div class="section-newsletter__form col-12">
                            {%- if section.settings.mailchimp -%}
                                {%- assign form_action = section.settings.newsletter_form_action | replace: '/post?', '/post-json?' | append: '&amp;c=?' -%}
                                <form action="{{ form_action }}" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank" class="js-vela-newsletter formNewsletter clearfix">			
                                    <input type="hidden" name="contact[tags]" value="newsletter">
                                    <div class="d-flex">
                                        <input class="js-input-newsletter form-control bg-transparent" type="email" value="{% if customer %}{{ customer.email }}{% endif %}" placeholder="{{ 'newsletter.newsletter_email' | t }}" name="EMAIL" id="mail" aria-label="{{ 'newsletter.newsletter_email' | t }}" aria-describedby="btn-newsletter" required>					
                                        <button class="btn btn--newsletter btn-default" type="submit">
                                            <span class="text d-block">{{ 'newsletter.button_label' | t }}</span>
                                            <i class="icons d-none">{% render 'icons', icon: 'paper-plane-o', attr: 'width="16"' %}</i>
                                        </button>
                                    </div>
                                </form>
                            {% else %}
                                {% form 'customer' %}
                                    {%- if form.errors -%}
                                        <div class="alert-error alert alert-danger alert-dismissible fade show">
                                            {{ form.errors | default_errors }}
                                            <button type="button" data-dismiss="alert" aria-hidden="true" data-bs-dismiss="alert" aria-label="Close" class="btn-close"></button>
                                        </div>
                                    {%- endif -%}
                                    {%- if form.posted_successfully? -%}
                                        <div class="alert-success alert alert-success">
                                            {{ 'newsletter.newsletter_confirmation' | t }}
                                        </div>
                                    {%- else -%}
                                        <input type="hidden" name="contact[tags]" value="newsletter">
                                        <div class="d-flex">
                                            <input class="form-control bg-transparent" id="newsletter-input" type="email" name="contact[email]" placeholder="{{ 'newsletter.newsletter_email' | t }}" required aria-describedby="btn-newsletter">
                                            <button class="btn btn--newsletter btn-default" type="submit">
                                                <span class="text d-block">{{ 'newsletter.button_label' | t }}</span>
                                                <i class="icons d-none">{% render 'icons', icon: 'paper-plane-o', attr: 'width="16"' %}</i>
                                            </button>
                                        </div>
                                        <input type="hidden" name="action" value="0">
                                    {%- endif -%}
                                {% endform %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            {%- endif -%}
        </div>
    </div>
</div>
{% schema %}
    {
        "name": "Newsletter",
        "tag": "section",
        "class": "velaFramework",
        "disabled_on": {
            "groups": ["header"]
        },
        "settings": [
            {
                "type": "header",
                "content": "Design Section"
            },
            {
                "type": "checkbox",
                "id": "full_with",
                "label": "Make section full width"
            },
            {
                "type": "text",
                "id": "max_with",
                "label": "Container max width?(px)",
                "info": "Ex: 1440px"
            },
            {
                "type": "color",
                "id": "color_bg",
                "label": "Background Color",
                "default": "#fff"
            },
            {
                "type": "image_picker",
                "id": "image_bg",
                "label": "Background Image"
            },
            {
                "type": "text",
                "id": "padding_block",
                "label": "Padding",
                "placeholder": "0px 0px",
                "info": "Ex: 0px 0px 0px 0px and use desktop only"
            },
            {
                "type": "text",
                "id": "padding_block_m",
                "label": "Padding on mobile",
                "placeholder": "0px 0px",
                "info": "Ex: 0px 0px 0px 0px and use mobile only"
            },
            {
                "type": "text",
                "id": "margin_block_d",
                "label": "Margin",
                "placeholder": "0px 0px",
                "info": "Ex: 0px 0px 0px 0px and use desktop only"
            },
            {
                "type": "text",
                "id": "margin_block_m",
                "label": "Margin on mobile",
                "placeholder": "0px 0px",
                "info": "Ex: 0px 0px 0px 0px and use mobile only"
            },
            {
                "type": "header",
                "content": "Layout Settings"
            },
            {
                "type": "select",
                "id": "newsletter_layout",
                "label": "Layout",
                "default": "style1",
                "options": [
                    {
                        "value": "style1",
                        "label": "Style1"
                    },
                    {
                        "value": "style2",
                        "label": "Style2"
                    }
                ]
            },
            {
                "type": "header",
                "content": "Item settings"
            },
            {
                "type": "html",
                "id": "heading",
                "label": "Heading",
                "placeholder": "Heading"
            },
            {
                "type": "textarea",
                "id": "description",
                "placeholder": "Description for block",
                "label": "Description"
            },
            {
                "type": "checkbox",
                "id": "mailchimp",
                "label": "Use mailChimp",
                "default": false
            },
            {
				"type": "paragraph",
				"content": "Uncheck if You use Newsletter of Shopify. Email will be saved to shopify customer. Admin -> Customers -> Accepts Marketting. You must send invite account for customer."
			},
			{
				"type": "text",
				"id": "newsletter_form_action",
				"label": "MailChimp form action URL",
				"info": "[Where do I find my MailChimp form action URL?](https:\/\/www.youtube.com/watch?v=mQ6UFLP_iEI)"
			}
        ],
        "presets": [
            {
                "name": "Newsletter",
                "category": "5. Vela Element",
				"settings": {
					"heading": "Vela Newsletter"
				}
            }
        ]
	}
{% endschema %}