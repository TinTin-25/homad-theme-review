{{- 'heading-filter.css' | asset_url | stylesheet_tag -}}
{%- include 'section_style' -%}
{%- liquid
  assign classes = ''
  if section.settings.full_width and section.settings.max_width
    assign classes = ' mx-auto'
  endif
  assign product_vendors = section.settings.vendors | split: ','
%}

<div class="vela-section heading-filter overflow-hidden{{ classes }}" style="{{- section_style -}}">
  <div class="container{% if section.settings.full_width %}-full{% endif %}">
    <div class="vela-section-inner position-relative">
      <hvduc-heading class="hvduc-heading">
        <form action="/" data-root="{{ routes.root_url }}">
          <div class="hvduc-heading__inner d-flex flex-wrap justify-content-center pb-2 pb-lg-5">
            <span class="hvduc-heading__text h3 lh-1 text-secondary">{{ section.settings.heading }}</span>
            <hvduc-select class="hvduc-select">
              <div class="hvduc-select__container" data-select="container"></div>
              <select class="hvduc-heading__select" name="filter.p.vendor" data-filter="vendors">
                <option value="" selected>{{ 'sections.header.everything' | t }}</option>
                {%- for vendor in product_vendors -%}
                  {%- assign value = vendor | strip -%}
                  <option value="{{ value }}">{{ value }}</option>
                {%- endfor -%}
              </select>
            </hvduc-select>
            <span class="hvduc-heading__text h3 lh-1 text-secondary">{{ section.settings.preposition }}</span>
            <hvduc-select class="hvduc-select">
              <div class="hvduc-select__container" data-select="container"></div>
              <select class="hvduc-heading__select" data-filter="categories">
                <option value="{{ routes.all_products_collection_url }}" selected>{{ 'sections.header.all_categories' | t }}</option>
                {%- for link in section.settings.categories_menu.links -%}
                  {%- if link.type == 'collection_link' -%}
                    <option value="{{ link.object.url }}">{{- link.object.title | escape -}}</option>
                  {%- endif -%}
                {%- endfor -%}
              </select>
            </hvduc-select>
            <button class="btn-link bg-transparent border-0 h3 lh-1 mb-0 p-0 ms-1" hidden data-button="submit" type="submit">
              {% render 'icons', class="mx-1" icon: 'arrow-right-long', attr: 'width="24" height="24"' %}
              {{ 'general.search.search' | t }}
            </button>
          </div>
        </form>
        {%- liquid
          assign products_default = collections['all'].products
          assign column_large = section.settings.desktop_column
          assign column_middle = section.settings.tablet_column
          assign column_small = section.settings.mobile_column
          assign limit = section.settings.limit | plus: 0
        -%}
        <div class="heading-filter__content hvduc-heading__content position-relative">
          
          <div
            class="hvduc-heading__grid row gx-2 gx-md-3 g-lg-4 gy-4 gy-lg-5 row-cols-{{ column_small }} row-cols-md-{{ column_middle }} row-cols-lg-{{ column_large }}"
            data-limit="{{ limit }}"
          >
            {%- for product in products_default limit: limit -%}
              <div class="col">{% include 'product-grid-item' %}</div>
            {%- endfor -%}
          </div>
          {%- if section.settings.loadmore_label != blank -%}
            <div class="hvduc-heading__loadmore text-center pt-lg-3" {% unless products_default.size > limit %}hidden{% endunless %}>
              <a class="btn--viewall fs-6 btn mt-4 mt-md-5" href="{{ routes.all_products_collection_url }}">{{ section.settings.loadmore_label }}</a>
            </div>
          {%- endif -%}
          <div
            class="hvduc-heading__empty alert alert-warning text-center"
            {% if products_default.size != 0 %}hidden{% endif %}
          >{{ 'sections.collection_template.empty' | t }}</div>
          {% render 'preloading', preload_class: 'position-absolute mt-3' %}
        </div>
      </hvduc-heading>
    </div>
  </div>
</div>

<script src="{{ 'heading-filter.js' | asset_url }}" defer="defer"></script>

{% schema %}
{
  "name": "Heading & Filter",
  "tag": "section",
  "class": "velaFramework",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings":[
    {
      "type": "header",
      "content": "Design Section"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Make section full width"
    },
    {
      "type": "text",
      "id": "max_width",
      "label": "Container max width?(px)",
      "info": "Ex: 1440px"
    },
    {
      "type": "color",
      "id": "color_bg",
      "label": "Background color",
      "default": "rgba(0,0,0,0)"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Color",
      "default": "#000000"
    },
    {
      "type": "text",
      "id": "padding_block",
      "label": "Padding",
      "placeholder": "0px 0px",
      "info": "Ex: 0px 0px 0px 0px"
    },
    {
      "type": "text",
      "id": "padding_block_m",
      "label": "Padding on mobile",
      "placeholder": "0px 0px",
      "info": "Ex: 0px 0px 0px 0px and use mobile only"
    },
    {
      "type": "text",
      "id": "margin_block",
      "label": "Margin",
      "placeholder": "0px 0px",
      "default": "0 0 60px",
      "info": "Ex: 0px 0px 0px 0px"
    },
    {
      "type": "header",
      "content": "t:sections.global.settings.header_settings.content"
    },
    {
      "type": "html",
      "id": "heading",
      "label": "t:sections.global.settings.heading_section.label",
      "default": "Heading"
    },
    {
      "type": "text",
      "id": "preposition",
      "label": "Preposition",
      "default": "in"
    },
    {
      "type": "link_list",
      "id": "categories_menu",
      "label": "List of categories"
    },
    {
      "type": "textarea",
      "id": "vendors",
      "label": "List of vendors",
      "info": "Write multiple product vendors (separated by commas)."
    },
    {
      "type": "inline_richtext",
      "id": "button_label",
      "label": "Button label",
      "default": "Search"
    },
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "range",
      "id": "limit",
      "min": 1,
      "max": 16,
      "step": 1,
      "label": "Maximum products to show",
      "default": 8
    },
    {
      "type": "text",
      "id": "loadmore_label",
      "label": "Load more label",
      "default": "Load more items",
      "info": "Leave blank if you want to hide the load more button."
    },
    {
      "type": "range",
      "id": "desktop_column",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 4,
      "label": "Products item per row",
      "info": "On the Desktop"
    },
    {
      "type": "range",
      "id": "tablet_column",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 3,
      "label": "Products item per row",
      "info": "On the Tablets"
    },
    {
      "type": "range",
      "id": "mobile_column",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 2,
      "label": "Products item per row",
      "info": "On the Mobile"
    }
  ],
  "presets": [
    {
      "name": "Heading & Filter"
    }
  ]
}
{% endschema %}
