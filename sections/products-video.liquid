{{ 'videos.css' | asset_url | stylesheet_tag }}
{%- include 'section_style' -%}
 <div class="vela-section section-products-video overflow-hidden{% if section.settings.full_with and section.settings.max_with %} mx-auto{% endif %}" style="{{- section_style -}}">
     <div class="container{% if section.settings.full_with %}-fluid{% endif %}">
         <div class="vela-section__inner">
             <div class="vela-section__content position-relative">
                <div class="row g-2 g-md-3">
                    <div class="video-section col-12 col-md-12 col-lg-9">
                        <deferred-media class="video-section__media overflow-hidden d-block w-100" data-media-id="{{ section.settings.video_url.id }}"
                            {% if section.settings.cover_image != blank %} style="padding-bottom: {{ 1 | divided_by: section.settings.cover_image.aspect_ratio | times: 100 }}%;"{% endif %}
                            >
                                <button
                                id="Deferred-Poster-Modal-{{ section.settings.video_url.id }}"
                                class="video-section__poster media deferred-media__poster media--landscape"
                                type="button"
                                >
                                    {%- if section.settings.cover_image != blank -%}
                                        {% render 'img-global', image: section.settings.cover_image %}
                                    {%- else -%}
                                        {{ 'collection-2' | placeholder_svg_tag: 'placeholder-svg placeholder' }}
                                    {%- endif -%}
                                    <span class="deferred-media__poster-button d-flex align-items-center justify-content-center video-btn--play position-absolute p-0 top-50 start-50 translate-middle rounded-circle">
                                        {%- render 'icons', icon: 'play', class: 'icon icon-play ms-1' -%}
            
                                    </span>
                                </button>
                                <template>
                                {%- if section.settings.video_url.type == 'youtube' -%}
                                    <iframe src="https://www.youtube.com/embed/{{ section.settings.video_url.id }}?enablejsapi=1" class="js-youtube" allow="autoplay; encrypted-media" allowfullscreen title="{{ section.settings.description | escape }}"></iframe>
                                {%- else -%}
                                    <iframe src="https://player.vimeo.com/video/{{ section.settings.video_url.id }}" class="js-vimeo" allow="autoplay; encrypted-media" allowfullscreen title="{{ section.settings.description | escape }}"></iframe>
                                {%- endif -%}
                                </template>
                        </deferred-media>
                    </div>
                    <div class="products-video__product col-12 col-md-12 col-lg-3">
                        <div class="row g-2 row-cols-2 row-cols-sm-3 row-cols-lg-2">  
                            {% for block in section.blocks %}
                                <div class="col">  
                                    {%- assign product_handle = block.settings.product_handle -%}
                                    {% if product_handle == blank or  all_products[product_handle] == empty  %}
                                        <div class="product-card product-grid">
                                            <div class="product-grid__inner">
                                                <div class="product-card__image-wrapper">
                                                    <a class="product-card__image-link" href="/admin/products">
                                                        {%- capture current -%}{% cycle 1, 2, 3, 4, 5, 6 %}{%- endcapture -%}
                                                        {{ 'product-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
                                                    </a>
                                                    <div class="product-card__label position-absolute {{ settings.badge_position }}-0">
                                                        {%- if settings.product_card_new -%}
                                                            <span class="label-new position-relative"><span class="d-block overflow-hidden position-relative">{{ 'products.general.label_new' | t }}</span></span>
                                                        {%- endif -%}
                                                        {%- if forloop.index == 2 -%}
                                                            <span class="d-flex justify-content-start"><span class="label-on-sale d-block overflow-hidden py-1 px-2 rounded-pill mb-0">-10%</span></span>		
                                                        {%- endif -%}
                                                        {%- if forloop.index == 4 -%}
                                                            <span class="label-sold-out position-relative bg-warning heading-color"><span class="d-block overflow-hidden position-relative">{{ 'products.general.out_stock' | t }}</span></span>		
                                                        {%- endif -%}
                                                    </div>
                                                </div>
                                                <div class="product-card__content position-absolute start-0 bottom-0 px-3 p-1 text-center w-100">
                                                    <div class="product-card__content--inner">
                                                        <h6 class="product-card__name fw-semibold line-clamp-2 mb-2">
                                                            <a class="line-title fw-normal" href="/admin/products">Wicked lounge rattan</a>
                                                        </h6>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    {% else %}
                                        {%- assign product = all_products[product_handle] -%}
                                        <div class="product-card product-grid grid__style5">
                                            <div class="product-grid__inner position-relative overflow-hidden">
                                                <div class="product-card__image-wrapper">
                                                    <a class="product-card__image-link" href="{{ product.url }}" title="{{ product.title }}">
                                                        <div class="product-card__img-primary{% if product.media[1] != nil and settings.show_secondary_image %} img-primary{% endif %}">
                                                            {% render 'img-global', image: product.featured_media, image_ratio: settings.image_ratio, crop: image_crop, image_style: true %}
                                                        </div>
                                                        {%- if product.media[1] != nil and settings.show_secondary_image -%}
                                                            <div class="img-secondary position-absolute">
                                                                {% render 'img-global', image: product.media[1], image_ratio: settings.image_ratio, crop: image_crop , image_style: true %}
                                                            </div>
                                                        {%- endif -%}
                                                    </a>
                                                </div>
                                                <div class="product-card__content position-absolute start-0 bottom-0 px-2 p-1 text-center w-100">
                                                    <div class="product-card__content--inner">
                                                        <div class="product-group-price d-flex align-items-center justify-content-center w-100">
                                                            {% if product.price_varies  %}<span class="me-1">{{ 'products.product.from' | t}}:</span>{% endif %}
                                                            {%- if on_sale -%}
                                                                <div class="product-price product-price--regular me-1">{{ product.compare_at_price | money }}</div>
                                                            {%- endif -%}
                                                            <div class="product-price">{{ product.price | money }}</div>
                                                            {%- if product.price_varies == false and variant.unit_price_measurement -%}
                                                                {%- capture unit_price_separator -%}
                                                                    <span>/</span><span class="d-none">&nbsp;{{ 'general.accessibility.unit_price_separator' | t }}&nbsp;</span>
                                                                {%- endcapture -%}
                                                                {%- capture unit_price_base_unit -%}
                                                                    <span>
                                                                    {%- if variant.unit_price_measurement.reference_value != 1 -%}
                                                                        {{- variant.unit_price_measurement.reference_value -}}
                                                                    {%- endif -%}
                                                                    {{ variant.unit_price_measurement.reference_unit }}
                                                                    </span>
                                                                {%- endcapture -%}
                                                                <span class="product-unit-price">
                                                                    <span class="d-none">{{ 'products.general.unit_price' | t }}</span>
                                                                    <span>{{ variant.unit_price | money }}</span>{{- unit_price_separator -}}{{- unit_price_base_unit -}}
                                                                </span>
                                                            {%- endif -%}
                                                            {%- if shop.taxes_included and settings.product_card_tax -%}
                                                                <span class="ms-2">
                                                                    {{ 'products.general.include_taxes' | t }}
                                                                </span>
                                                            {%- endif -%}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    {% endif %}
                                </div>
                            {%- endfor -%}
                        </div>
                    </div>
                </div>
            </div>
         </div>
     </div>
 </div>
 {% schema %}
    {
        "name": "Product List Video",
        "tag": "section",
        "class": "velaFramework",
        "disabled_on": {
            "groups": ["header", "footer"]
        },
        "settings":[
            {
                "type": "header",
                "content": "t:sections.global.settings.header_section.content"
            },
            {
                "type": "checkbox",
                "id": "full_with",
                "label": "t:sections.global.settings.full_width.label"
            },
            {
                "type": "text",
                "id": "max_with",
                "label": "t:sections.global.settings.max_with.label",
                "info": "t:sections.global.settings.max_with.info"
            },
            {
                "type": "color",
                "id": "color_bg",
                "label": "t:sections.global.settings.bg_color.label",
                "default": "rgba(0,0,0,0)"
            },
            {
                "type": "text",
                "id": "padding_block",
                "label": "t:sections.global.settings.padding.label",
                "placeholder": "0px 0px",
                "info": "t:sections.global.settings.padding.info"
            },
            {
                "type": "text",
                "id": "padding_block_m",
                "label": "t:sections.global.settings.padding_mobile.label",
                "placeholder": "0px 0px",
                "info": "t:sections.global.settings.padding_mobile.info"
            },
            {
                "type": "text",
                "id": "margin_block",
                "label": "t:sections.global.settings.margin.label",
                "placeholder": "0px 0px"
            },
            {
                "type": "header",
                "content": "t:sections.global.settings.header_settings.content"
            },
            {
                "type": "select",
                "id": "space_between",
                "label": "t:sections.global.settings.space_between.label",
                "default": "4",
                "options": [
                    {
                        "value": "0",
                        "label": "t:sections.global.settings.space_between.option__1.label"
                    },
                    {
                        "value": "2",
                        "label": "t:sections.global.settings.space_between.option__2.label"
                    },
                    {
                        "value": "3",
                        "label": "t:sections.global.settings.space_between.option__3.label"
                    },
                    {
                        "value": "4",
                        "label": "t:sections.global.settings.space_between.option__4.label"
                    },
                    {
                        "value": "5",
                        "label": "t:sections.global.settings.space_between.option__5.label"
                    }
                ]
            },
            {
                "type": "select",
                "id": "video_position",
                "label": "t:sections.video-banner.settings.video_position.label",
                "default": "left",
                "options": [
                    {
                        "value": "left",
                        "label": "t:sections.video-banner.settings.video_position.option__1.label"
                    },
                    {
                        "value": "right",
                        "label": "t:sections.video-banner.settings.video_position.option__2.label"
                    }
                ]
            },
            {
                "type": "range",
                "id": "video_size",
                "min": 3,
                "max": 10,
                "step": 1,
                "label": "t:sections.video-banner.settings.video_size.label",
                "default": 10,
                "info": "t:sections.video-banner.settings.video_size.info"
            },
            {
                "type": "range",
                "id": "video_size_ipad",
                "min": 3,
                "max": 12,
                "step": 1,
                "label": "t:sections.video-banner.settings.video_size_ipad.label",
                "default": 6,
                "info": "t:sections.video-banner.settings.video_size_ipad.info"
            },
            {
                "type": "range",
                "id": "video_size_mobile",
                "min": 3,
                "max": 12,
                "step": 1,
                "label": "t:sections.video-banner.settings.video_size_mobile.label",
                "default": 12,
                "info": "t:sections.video-banner.settings.video_size_mobile.info"
            },
            {
                "type": "header",
                "content": "t:sections.video-banner.settings.header.content"
            },
            {
                "type": "image_picker",
                "id": "cover_image",
                "label": "t:sections.video-banner.settings.cover_image.label"
            },
            {
                "type": "video_url",
                "id": "video_url",
                "accept": [
                    "youtube",
                    "vimeo"
                ],
                "default": "https:\/\/www.youtube.com\/watch?v=_9VUPq3SxOc",
                "label": "t:sections.video-banner.settings.video_url.label",
                "placeholder": "t:sections.video-banner.settings.video_url.placeholder",
                "info": "t:sections.video-banner.settings.video_url.info"
            },
            {
                "type": "text",
                "id": "description",
                "label": "t:sections.video-banner.settings.description.label",
                "info": "t:sections.video-banner.settings.description.info"
            },
            {
                "type": "header",
                "content": "t:sections.video-banner.settings.header1.content"
            },
            {
                "type": "image_picker",
                "id": "html_bg",
                "label": "t:sections.video-banner.settings.html_bg.label"
            },
            {
                "type": "select",
                "id": "text_align",
                "label": "t:sections.video-banner.settings.text_align.label",
                "default": "start",
                "options": [
                    {
                        "value": "start",
                        "label": "t:sections.video-banner.settings.text_align.option__1.label"
                    },
                    {
                        "value": "center",
                        "label": "t:sections.video-banner.settings.text_align.option__2.label"
                    },
                    {
                        "value": "end",
                        "label": "t:sections.video-banner.settings.text_align.option__3.label"
                    }
                ]
            }
             
        ],
        "blocks": [
            {
                "type": "item",
                "name": "Add a product",
                "settings": [
                    {
                        "type": "product",
                        "id": "product_handle",
                        "label": "Select a product"
                    }
                ]
            }
        ],
        "presets": [
            {
                "name": "Product List Video",
                "blocks": [
                    {
                        "type": "item"
                    },
                    {
                        "type": "item"
                    },
                    {
                        "type": "item"
                    },
                    {
                        "type": "item"
                    },
                    {
                        "type": "item"
                    },
                    {
                        "type": "item"
                    }
                ]
            }
        ]
     }
 {% endschema %}