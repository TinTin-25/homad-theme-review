<div class="product-card product-grid grid__{{ product_style }}{% if slide_variableWidth %} box-width{% endif %}">
    <div class="product-grid__inner">
        <div class="product-card__image-wrapper mb-3">
            <a class="product-card__image-link rounded-2{% if sold_out %} image-out-of-stok{% endif %}" href="{{ product.url }}" title="{{ product.title | strip_html }}">
                <div class="product-card__img-primary{% if product.media[1] != nil and settings.show_secondary_image %} img-primary{% endif %}">
                    {% render 'img-global', image: product.featured_media.preview_image, image_ratio: settings.image_ratio, crop: image_crop, image_style: true %}
                </div>
                {%- if product.media[1] != nil and settings.show_secondary_image -%}
                    <div class="img-secondary position-absolute">
                        {% render 'img-global', image: product.media[1].preview_image, image_ratio: settings.image_ratio, crop: image_crop , image_style: true %}
                    </div>
                {%- endif -%}
            </a>
            <div class="product-card__label position-absolute d-flex flex-column {{ settings.badge_position }}-0">
                {%- if difference < 2592000 and settings.product_card_new -%}
                    <span class="d-flex justify-content-start"><span class="label-new d-block overflow-hidden py-1 px-2 rounded-pill mb-0">{{ 'products.general.label_new' | t }}</span></span>
                {%- endif -%}
                {%- if sold_out and settings.product_card_available -%}
                    <span class="d-flex justify-content-start"><span class="label-sold-out d-block overflow-hidden py-1 px-2 rounded-pill mb-0">{{ 'products.general.out_stock' | t }}</span></span>
                {%- elsif on_sale and settings.product_card_sale -%}
                    {%- capture saved_amount -%}{{ product.compare_at_price | minus: product.price | times: 100 | divided_by : product.compare_at_price }}{%- endcapture -%}
                    <span class="d-flex justify-content-start"><span class="label-on-sale d-block overflow-hidden py-1 px-2 rounded-pill mb-0">{% if settings.sale_style == 'percent' %}-{{ saved_amount }}%{% else %}{{ 'products.general.sale_price' | t }}{% endif %}</span></span>        
                {%- endif -%}
                {%- if preOrder -%}
                    <span class="d-flex justify-content-start"><span class="label-pre-order d-block overflow-hidden py-1 px-2 rounded-pill mb-0">{{ 'products.general.label_pre_order' | t }}</span></span>
                {%- endif -%}
            </div>
            {%- if settings.product_card_countdown and product.metafields.custom.countdown != blank -%}
                {% assign countdownTime = product.metafields.custom.countdown %} 
                <div class="product-card__countdown d-flex position-absolute bottom-0 start-50 translate-middle-x bg-white rounded-pill py-1 px-3" data-countdown="{{ countdownTime }}"></div>
            {%- endif -%}
            {%- if settings.product_wishlist and  settings.product_card_wishlist -%}
                <button type="button" aria-label="{{ 'products.product.wishlist' | t }}" class="{% if page_wishlist %}btn--wishlist-page {% endif %}js-btn-wishlist btn--wishlist position-absolute show-tooltip top-0 {% if settings.badge_position == 'start' %}end-0{% else %}start-0{% endif %}" data-product-handle="{{ product.handle }}">
                    {%- if page_wishlist -%}
                        {% render 'icons', icon: 'trash', attr: 'width="18" height="18"' %}
                    {%- else -%}
                        {% render 'icons', icon: 'heart', class: 'heart', attr: 'width="18" height="18"' %}
                        {% render 'icons', icon: 'heart-fill', class: 'heart-fill', attr: 'width="18" height="18"' %}
                    {%- endif -%}
                    <div class="tooltip bs-tooltip-{% if settings.badge_position == 'start' %}start{% else %}end{% endif %}" role="tooltip">
                        <div class="tooltip-arrow"></div>
                        <div class="tooltip-inner">
                            {{ 'products.product.add_to_wishlist' | t }}
                        </div>
                    </div>
                </button>
            {%- endif -%}
            <div class="shop-action position-absolute bottom-0 start-0 end-0 mx-3">
                <div class="shop-action__wrapper row g-1" style="--bs-gutter-x: 8px;">
                    {%- if settings.product_card_addtocart -%}
                        <div class="product-card__form d-flex justify-content-center d-lg-block{% if settings.quickview_enable %} col-12 col-lg-6{% else %} col-12{% endif %}">
                            {%- assign variant_count = product.variants | size -%}
                            <form action="{{ routes.cart_add_url }}" method="post" enctype="multipart/form-data" class="form-addtocart" data-product-form>
                                <input type="hidden" name="id" value="{{ variant.id }}" />
                                {%- if sold_out -%}
                                    {% if settings.outofstock_enable %}
                                        <product-card-bis class="product-card-bis">
                                            <button
                                                class="btn btn--action btn--add-to-cart w-100"
                                                aria-label="{{ 'products.product.notify_me' | t }}"
                                                data-button="bis"
                                                type="button"
                                                title="{{ settings.outofstock_title | escape }}"
                                            >
                                                {% render 'icons', icon: 'bell', class: "d-lg-none", attr: 'width="14" height="14"' %}
                                                <span class="text">{{ 'products.product.notify_me' | t }}</span>
                                            </button>
                                            {%- assign curr_variant = product.selected_or_first_available_variant -%}
                                            {%- render 'product-bis-notification', product: product, current_variant: curr_variant -%}
                                        </product-card-bis>
                                    {% endif %}
                                {%- else -%}
                                    {%- if variant_count > 1 -%}
                                        {%- if settings.quickadd_enable -%}
                                            <button
                                                class="js-btn-quickadd btn--action btn btn--add-to-cart w-100"
                                                aria-label="{% if preOrder %}{{ 'products.product.pre_order' | t }}{% else %}{{ 'products.product.quickadd' | t }}{% endif %}"
                                                data-preorder="{{ preOrder }}"
                                                data-handle="{{ product.handle }}"
                                                data-color-label="{{ settings.product_cart_swatch_label | escape }}"
                                            >
                                                {% render 'icons', icon: 'handbag', class: 'icon-cart d-lg-none', attr: 'width="14" height="14"' %}
                                                <span class="text">{% if preOrder %}{{ 'products.product.pre_order' | t }}{% else %}{{ 'products.product.quickadd' | t }}{% endif %}</span>
                                            </button>
                                        {%- else -%}
                                            <a class="btn btn--action btn--add-to-cart" href="{{ product.url }}" title="{{ 'products.product.select_options' | t }}">
                                                {% render 'icons', icon: 'handbag', class: 'icon-cart d-lg-none', attr: 'width="14" height="14"' %}
                                                <span class="text">{{ 'products.product.select_options' | t }}</span>
                                            </a>
                                        {%- endif -%}
                                    {%- else -%}
                                        <button
                                            class="btn--action btn btn--add-to-cart w-100"
                                            type="submit"
                                            value="Submit"
                                            title="{% if preOrder %}{{ 'products.product.pre_order' | t }}{% else %}{{ 'products.product.add_to_cart' | t }}{% endif %}"
                                            aria-label="{% if preOrder %}{{ 'products.product.pre_order' | t }}{% else %}{{ 'products.product.add_to_cart' | t }}{% endif %}"
                                        >
                                            {% render 'icons', icon: 'handbag', class: 'icon-cart d-lg-none', attr: 'width="14" height="14"' %}
                                            <span class="text">{% if preOrder %}{{ 'products.product.pre_order' | t }}{% else %}{{ 'products.product.add_to_cart' | t }}{% endif %}</span>
                                        </button>
                                    {%- endif -%}
                                {%- endif -%}
                            </form>
                        </div>
                    {%- endif -%}
                    {%- if settings.quickview_enable -%}
                        <div class="{% if settings.product_card_addtocart %}col-6{% else %}col-12{% endif %} d-none d-lg-block">
                            <button class="js-btn-quickview btn btn--action btn--quickview"  data-preorder="{{ preOrder }}" data-handle="{{ product.handle }}" data-color-label="{{ settings.product_cart_swatch_label | escape }}">
                                {% render 'icons', icon: 'search', class: 'd-none', attr: 'width="22" height="22"' %}
                                <span class="text">{{ 'products.product.quickview' | t }}</span>
                                <div class="d-none proShortDesc">
                                    {{ shortDescription }}
                                </div>
                            </button>
                        </div>
                    {%- endif -%}
                </div>
            </div>
        </div>
        <div class="product-card__content">
            <div class="product-card__content--inner text-center">
                {%- if settings.product_vendor_enable -%}
                    <div class="product-card__vendor mb-1"><label class="me-1">{{'products.general.label_vendor' | t }}</label>{{ product.vendor | link_to_vendor }}</div>
                {%- endif -%}
                {%- if settings.product_reviews_enable -%}
                    <div class="product-card__review product-review mb-2{% if settings.product_card_review %} d-flex justify-content-center{% else %} d-none{% endif %}">
                        {% render 'product-review-card', product: product %}
                    </div>
                {%- endif -%}
                <h6 class="product-card__name fs-6 line-clamp-2 mb-2">
                    <a class="line-title fw-bold" href="{{ product.url }}" title="{{ product.title | strip_html }}">{{ product.title }}</a>
                </h6>
                <div class="product-group-price d-flex align-items-center justify-content-center w-100 lh-1">
                    {% render 'product-card-price', product: product, on_sale: on_sale %}
                </div>
                {%- if settings.product_card_swatch -%}
                    {%- render 'product-card-swatch', product: product, swatch_position: 'center' -%}
                {%- endif -%}
                {%- if shortDescription != blank and settings.product_card_shortdesc -%}
                    <div class="product-card__summary pt-2">{{ shortDescription }}</div>
                {%- endif -%}
            </div>
        </div>
    </div>
</div>
